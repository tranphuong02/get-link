/*! ColReorder 1.1.3
 * ©2010-2014 SpryMedia Ltd - datatables.net/license
 */
(function(n,t,i){function u(n){for(var i=[],t=0,r=n.length;t<r;t++)i[n[t]]=t;return i}function r(n,t,i){var r=n.splice(t,1)[0];n.splice(i,0,r)}function f(n,t,i){for(var f,u=[],r=0,e=n.childNodes.length;r<e;r++)n.childNodes[r].nodeType==1&&u.push(n.childNodes[r]);f=u[t];i!==null?n.insertBefore(f,u[i]):n.appendChild(f)}var e=function(n){"use strict";n.fn.dataTableExt.oApi.fnColReorder=function(t,i,e){var w=n.fn.dataTable.Api?!0:!1,o,s,p,g,a=t.aoColumns.length,v,h,b=function(n,t,i){if(n[t]){var r=n[t].split("."),u=r.shift();isNaN(u*1)||(n[t]=i[u*1]+"."+r.join("."))}},k,c,d,y,l,nt;if(i!=e){if(i<0||i>=a){this.oApi._fnLog(t,1,"ColReorder 'from' index is out of bounds: "+i);return}if(e<0||e>=a){this.oApi._fnLog(t,1,"ColReorder 'to' index is out of bounds: "+e);return}for(k=[],o=0,s=a;o<s;o++)k[o]=o;for(r(k,i,e),c=u(k),o=0,s=t.aaSorting.length;o<s;o++)t.aaSorting[o][0]=c[t.aaSorting[o][0]];if(t.aaSortingFixed!==null)for(o=0,s=t.aaSortingFixed.length;o<s;o++)t.aaSortingFixed[o][0]=c[t.aaSortingFixed[o][0]];for(o=0,s=a;o<s;o++){for(h=t.aoColumns[o],p=0,g=h.aDataSort.length;p<g;p++)h.aDataSort[p]=c[h.aDataSort[p]];w&&(h.idx=c[h.idx])}for(w&&n.each(t.aLastSort,function(n,i){t.aLastSort[n].src=c[i.src]}),o=0,s=a;o<s;o++)h=t.aoColumns[o],typeof h.mData=="number"?(h.mData=c[h.mData],t.oApi._fnColumnOptions(t,o,{})):n.isPlainObject(h.mData)&&(b(h.mData,"_",c),b(h.mData,"filter",c),b(h.mData,"sort",c),b(h.mData,"type",c),t.oApi._fnColumnOptions(t,o,{}));if(t.aoColumns[i].bVisible){for(d=this.oApi._fnColumnIndexToVisible(t,i),y=null,o=e<i?e:e+1;y===null&&o<a;)y=this.oApi._fnColumnIndexToVisible(t,o),o++;for(v=t.nTHead.getElementsByTagName("tr"),o=0,s=v.length;o<s;o++)f(v[o],d,y);if(t.nTFoot!==null)for(v=t.nTFoot.getElementsByTagName("tr"),o=0,s=v.length;o<s;o++)f(v[o],d,y);for(o=0,s=t.aoData.length;o<s;o++)t.aoData[o].nTr!==null&&f(t.aoData[o].nTr,d,y)}for(r(t.aoColumns,i,e),r(t.aoPreSearchCols,i,e),o=0,s=t.aoData.length;o<s;o++)l=t.aoData[o],w?(l.anCells&&r(l.anCells,i,e),l.src!=="dom"&&n.isArray(l._aData)&&r(l._aData,i,e)):(n.isArray(l._aData)&&r(l._aData,i,e),r(l._anHidden,i,e));for(o=0,s=t.aoHeader.length;o<s;o++)r(t.aoHeader[o],i,e);if(t.aoFooter!==null)for(o=0,s=t.aoFooter.length;o<s;o++)r(t.aoFooter[o],i,e);for(w&&(nt=new n.fn.dataTable.Api(t),nt.rows().invalidate()),o=0,s=a;o<s;o++)n(t.aoColumns[o].nTh).off("click.DT"),this.oApi._fnSortAttachListener(t,t.aoColumns[o].nTh,o);n(t.oInstance).trigger("column-reorder",[t,{iFrom:i,iTo:e,aiInvertMapping:c}])}};var e=function(t,i){var r,u;if(n.fn.dataTable.Api?r=new n.fn.dataTable.Api(t).settings()[0]:t.fnSettings?r=t.fnSettings():typeof t=="string"?n.fn.dataTable.fnIsDataTable(n(t)[0])&&(r=n(t).eq(0).dataTable().fnSettings()):t.nodeName&&t.nodeName.toLowerCase()==="table"?n.fn.dataTable.fnIsDataTable(t.nodeName)&&(r=n(t.nodeName).dataTable().fnSettings()):t instanceof jQuery?n.fn.dataTable.fnIsDataTable(t[0])&&(r=t.eq(0).dataTable().fnSettings()):r=t,r._colReorder)throw"ColReorder already initialised on table #"+r.nTable.id;return u=n.fn.dataTable.camelToHungarian,u&&(u(e.defaults,e.defaults,!0),u(e.defaults,i||{})),this.s={dt:null,init:n.extend(!0,{},e.defaults,i),fixed:0,fixedRight:0,reorderCallback:null,mouse:{startX:-1,startY:-1,offsetX:-1,offsetY:-1,target:-1,targetIndex:-1,fromIndex:-1},aoTargets:[]},this.dom={drag:null,pointer:null},this.s.dt=r,this.s.dt._colReorder=this,this._fnConstruct(),r.oApi._fnCallbackReg(r,"aoDestroyCallback",n.proxy(this._fnDestroy,this),"ColReorder"),this};return e.prototype={fnReset:function(){for(var t=[],n=0,i=this.s.dt.aoColumns.length;n<i;n++)t.push(this.s.dt.aoColumns[n]._ColReorder_iOrigCol);return this._fnOrderColumns(t),this},fnGetCurrentOrder:function(){return this.fnOrder()},fnOrder:function(n){var r,t,f;if(n===i){for(r=[],t=0,f=this.s.dt.aoColumns.length;t<f;t++)r.push(this.s.dt.aoColumns[t]._ColReorder_iOrigCol);return r}return this._fnOrderColumns(u(n)),this},_fnConstruct:function(){var t=this,f=this.s.dt.aoColumns.length,n,i,r,e;for(this.s.init.iFixedColumns&&(this.s.fixed=this.s.init.iFixedColumns),this.s.fixedRight=this.s.init.iFixedColumnsRight?this.s.init.iFixedColumnsRight:0,this.s.init.fnReorderCallback&&(this.s.reorderCallback=this.s.init.fnReorderCallback),n=0;n<f;n++)n>this.s.fixed-1&&n<f-this.s.fixedRight&&this._fnMouseListener(n,this.s.dt.aoColumns[n].nTh),this.s.dt.aoColumns[n]._ColReorder_iOrigCol=n;this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoStateSaveParams",function(n,i){t._fnStateSave.call(t,i)},"ColReorder_State");i=null;this.s.init.aiOrder&&(i=this.s.init.aiOrder.slice());this.s.dt.oLoadedState&&typeof this.s.dt.oLoadedState.ColReorder!="undefined"&&this.s.dt.oLoadedState.ColReorder.length==this.s.dt.aoColumns.length&&(i=this.s.dt.oLoadedState.ColReorder);i?t.s.dt._bInitComplete?(e=u(i),t._fnOrderColumns.call(t,e)):(r=!1,this.s.dt.aoDrawCallback.push({fn:function(){if(!t.s.dt._bInitComplete&&!r){r=!0;var n=u(i);t._fnOrderColumns.call(t,n)}},sName:"ColReorder_Pre"})):this._fnSetColumnIndexes()},_fnOrderColumns:function(t){var i,f,u;if(t.length!=this.s.dt.aoColumns.length){this.s.dt.oInstance.oApi._fnLog(this.s.dt,1,"ColReorder - array reorder does not match known number of columns. Skipping.");return}for(i=0,f=t.length;i<f;i++)u=n.inArray(i,t),i!=u&&(r(t,u,i),this.s.dt.oInstance.fnColReorder(u,i));(this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!=="")&&this.s.dt.oInstance.fnAdjustColumnSizing(!1);this.s.dt.oInstance.oApi._fnSaveState(this.s.dt);this._fnSetColumnIndexes();this.s.reorderCallback!==null&&this.s.reorderCallback.call(this)},_fnStateSave:function(t){var i,f,r,s=this.s.dt,u=s.aoColumns,e,o;if(t.ColReorder=[],t.aaSorting){for(i=0;i<t.aaSorting.length;i++)t.aaSorting[i][0]=u[t.aaSorting[i][0]]._ColReorder_iOrigCol;for(e=n.extend(!0,[],t.aoSearchCols),i=0,f=u.length;i<f;i++)r=u[i]._ColReorder_iOrigCol,t.aoSearchCols[r]=e[i],t.abVisCols[r]=u[i].bVisible,t.ColReorder.push(r)}else if(t.order){for(i=0;i<t.order.length;i++)t.order[i][0]=u[t.order[i][0]]._ColReorder_iOrigCol;for(o=n.extend(!0,[],t.columns),i=0,f=u.length;i<f;i++)r=u[i]._ColReorder_iOrigCol,t.columns[r]=o[i],t.ColReorder.push(r)}},_fnMouseListener:function(t,i){var r=this;n(i).on("mousedown.ColReorder",function(n){n.preventDefault();r._fnMouseDown.call(r,n,i)})},_fnMouseDown:function(r,u){var f=this,s=n(r.target).closest("th, td"),o=s.offset(),e=parseInt(n(u).attr("data-column-index"),10);if(e!==i){this.s.mouse.startX=r.pageX;this.s.mouse.startY=r.pageY;this.s.mouse.offsetX=r.pageX-o.left;this.s.mouse.offsetY=r.pageY-o.top;this.s.mouse.target=this.s.dt.aoColumns[e].nTh;this.s.mouse.targetIndex=e;this.s.mouse.fromIndex=e;this._fnRegions();n(t).on("mousemove.ColReorder",function(n){f._fnMouseMove.call(f,n)}).on("mouseup.ColReorder",function(n){f._fnMouseUp.call(f,n)})}},_fnMouseMove:function(n){var f=this,i,r,t,u;if(this.dom.drag===null){if(Math.pow(Math.pow(n.pageX-this.s.mouse.startX,2)+Math.pow(n.pageY-this.s.mouse.startY,2),.5)<5)return;this._fnCreateDragNode()}for(this.dom.drag.css({left:n.pageX-this.s.mouse.offsetX,top:n.pageY-this.s.mouse.offsetY}),i=!1,r=this.s.mouse.toIndex,t=1,u=this.s.aoTargets.length;t<u;t++)if(n.pageX<this.s.aoTargets[t-1].x+(this.s.aoTargets[t].x-this.s.aoTargets[t-1].x)/2){this.dom.pointer.css("left",this.s.aoTargets[t-1].x);this.s.mouse.toIndex=this.s.aoTargets[t-1].to;i=!0;break}i||(this.dom.pointer.css("left",this.s.aoTargets[this.s.aoTargets.length-1].x),this.s.mouse.toIndex=this.s.aoTargets[this.s.aoTargets.length-1].to);this.s.init.bRealtime&&r!==this.s.mouse.toIndex&&(this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex),this.s.mouse.fromIndex=this.s.mouse.toIndex,this._fnRegions())},_fnMouseUp:function(){var i=this;n(t).off("mousemove.ColReorder mouseup.ColReorder");this.dom.drag!==null&&(this.dom.drag.remove(),this.dom.pointer.remove(),this.dom.drag=null,this.dom.pointer=null,this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex),this._fnSetColumnIndexes(),(this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!=="")&&this.s.dt.oInstance.fnAdjustColumnSizing(!1),this.s.dt.oInstance.oApi._fnSaveState(this.s.dt),this.s.reorderCallback!==null&&this.s.reorderCallback.call(this))},_fnRegions:function(){var i=this.s.dt.aoColumns,r,t,u;for(this.s.aoTargets.splice(0,this.s.aoTargets.length),this.s.aoTargets.push({x:n(this.s.dt.nTable).offset().left,to:0}),r=0,t=0,u=i.length;t<u;t++)t!=this.s.mouse.fromIndex&&r++,i[t].bVisible&&this.s.aoTargets.push({x:n(i[t].nTh).offset().left+n(i[t].nTh).outerWidth(),to:r});this.s.fixedRight!==0&&this.s.aoTargets.splice(this.s.aoTargets.length-this.s.fixedRight);this.s.fixed!==0&&this.s.aoTargets.splice(0,this.s.fixed)},_fnCreateDragNode:function(){var i=this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!=="",t=this.s.dt.aoColumns[this.s.mouse.targetIndex].nTh,r=t.parentNode,u=r.parentNode,f=u.parentNode,e=n(t).clone();this.dom.drag=n(f.cloneNode(!1)).addClass("DTCR_clonedTable").append(n(u.cloneNode(!1)).append(n(r.cloneNode(!1)).append(e[0]))).css({position:"absolute",top:0,left:0,width:n(t).outerWidth(),height:n(t).outerHeight()}).appendTo("body");this.dom.pointer=n("<div><\/div>").addClass("DTCR_pointer").css({position:"absolute",top:i?n("div.dataTables_scroll",this.s.dt.nTableWrapper).offset().top:n(this.s.dt.nTable).offset().top,height:i?n("div.dataTables_scroll",this.s.dt.nTableWrapper).height():n(this.s.dt.nTable).height()}).appendTo("body")},_fnDestroy:function(){for(var t=0,i=this.s.dt.aoDrawCallback.length;t<i;t++)if(this.s.dt.aoDrawCallback[t].sName==="ColReorder_Pre"){this.s.dt.aoDrawCallback.splice(t,1);break}n(this.s.dt.nTHead).find("*").off(".ColReorder");n.each(this.s.dt.aoColumns,function(t,i){n(i.nTh).removeAttr("data-column-index")});this.s.dt._colReorder=null;this.s=null},_fnSetColumnIndexes:function(){n.each(this.s.dt.aoColumns,function(t,i){n(i.nTh).attr("data-column-index",t)})}},e.defaults={aiOrder:null,bRealtime:!1,iFixedColumns:0,iFixedColumnsRight:0,fnReorderCallback:null},e.version="1.1.3",n.fn.dataTable.ColReorder=e,n.fn.DataTable.ColReorder=e,typeof n.fn.dataTable=="function"&&typeof n.fn.dataTableExt.fnVersionCheck=="function"&&n.fn.dataTableExt.fnVersionCheck("1.9.3")?n.fn.dataTableExt.aoFeatures.push({fnInit:function(n){var r=n.oInstance,t,i;return n._colReorder?r.oApi._fnLog(n,1,"ColReorder attempted to initialise twice. Ignoring second"):(t=n.oInit,i=t.colReorder||t.oColReorder||{},new e(n,i)),null},cFeature:"R",sFeature:"ColReorder"}):alert("Warning: ColReorder requires DataTables 1.9.3 or greater - www.datatables.net/download"),n.fn.dataTable.Api&&(n.fn.dataTable.Api.register("colReorder.reset()",function(){return this.iterator("table",function(n){n._colReorder.fnReset()})}),n.fn.dataTable.Api.register("colReorder.order()",function(n){return n?this.iterator("table",function(t){t._colReorder.fnOrder(n)}):this.context.length?this.context[0]._colReorder.fnOrder():null})),e};typeof define=="function"&&define.amd?define(["jquery","datatables"],e):typeof exports=="object"?e(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.ColReorder&&e(jQuery,jQuery.fn.dataTable)})(window,document);
//# sourceMappingURL=dataTables.colReorder.min.js.map
