/*! Scroller 1.2.2
 * ©2011-2014 SpryMedia Ltd - datatables.net/license
 */
(function(n,t,i){var r=function(r){"use strict";var u=function(n,i){if(!this instanceof u){alert("Scroller warning: Scroller must be initialised with the 'new' keyword.");return}typeof i=="undefined"&&(i={});this.s={dt:n,tableTop:0,tableBottom:0,redrawTop:0,redrawBottom:0,autoHeight:!0,viewportRows:0,stateTO:null,drawTO:null,heights:{jump:null,page:null,virtual:null,scroll:null,row:null,viewport:null},topRowFloat:0,scrollDrawDiff:null,loaderVisible:!1};this.s=r.extend(this.s,u.oDefaults,i);this.s.heights.row=this.s.rowHeight;this.dom={force:t.createElement("div"),scroller:null,table:null,loader:null};this.s.dt.oScroller=this;this._fnConstruct()},f;return u.prototype={fnRowToPixels:function(n,t,r){var u,f;return r?u=this._domain("virtualToPhysical",n*this.s.heights.row):(f=n-this.s.baseRowTop,u=this.s.baseScrollTop+f*this.s.heights.row),t||t===i?parseInt(u,10):u},fnPixelsToRow:function(n,t,r){var f=n-this.s.baseScrollTop,u=r?this._domain("physicalToVirtual",n)/this.s.heights.row:f/this.s.heights.row+this.s.baseRowTop;return t||t===i?parseInt(u,10):u},fnScrollToRow:function(n,t){var e=this,f=!1,i=this.fnRowToPixels(n),o=(this.s.displayBuffer-1)/2*this.s.viewportRows,u=n-o;u<0&&(u=0);(i>this.s.redrawBottom||i<this.s.redrawTop)&&this.s.dt._iDisplayStart!==u&&(f=!0,i=this.fnRowToPixels(n,!1,!0));typeof t=="undefined"||t?(this.s.ani=f,r(this.dom.scroller).animate({scrollTop:i},function(){setTimeout(function(){e.s.ani=!1},25)})):r(this.dom.scroller).scrollTop(i)},fnMeasure:function(n){this.s.autoHeight&&this._fnCalcRowHeight();var t=this.s.heights;t.viewport=r(this.dom.scroller).height();this.s.viewportRows=parseInt(t.viewport/t.row,10)+1;this.s.dt._iDisplayLength=this.s.viewportRows*this.s.displayBuffer;(n===i||n)&&this.s.dt.oInstance.fnDraw()},_fnConstruct:function(){var t=this,i;if(!this.s.dt.oFeatures.bPaginate){this.s.dt.oApi._fnLog(this.s.dt,0,"Pagination must be enabled for Scroller");return}this.dom.force.style.position="absolute";this.dom.force.style.top="0px";this.dom.force.style.left="0px";this.dom.force.style.width="1px";this.dom.scroller=r("div."+this.s.dt.oClasses.sScrollBody,this.s.dt.nTableWrapper)[0];this.dom.scroller.appendChild(this.dom.force);this.dom.scroller.style.position="relative";this.dom.table=r(">table",this.dom.scroller)[0];this.dom.table.style.position="absolute";this.dom.table.style.top="0px";this.dom.table.style.left="0px";r(this.s.dt.nTableWrapper).addClass("DTS");this.s.loadingIndicator&&(this.dom.loader=r('<div class="DTS_Loading">'+this.s.dt.oLanguage.sLoadingRecords+"<\/div>").css("display","none"),r(this.dom.scroller.parentNode).css("position","relative").append(this.dom.loader));this.s.heights.row&&this.s.heights.row!="auto"&&(this.s.autoHeight=!1);this.fnMeasure(!1);this.s.ingnoreScroll=!0;this.s.stateSaveThrottle=this.s.dt.oApi._fnThrottle(function(){t.s.dt.oApi._fnSaveState(t.s.dt)},500);r(this.dom.scroller).on("scroll.DTS",function(){t._fnScroll.call(t)});r(this.dom.scroller).on("touchstart.DTS",function(){t._fnScroll.call(t)});this.s.dt.aoDrawCallback.push({fn:function(){t.s.dt.bInitialised&&t._fnDrawCallback.call(t)},sName:"Scroller"});r(n).on("resize.DTS",function(){t.fnMeasure(!1);t._fnInfo()});i=!0;this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoStateSaveParams",function(n,r){i&&t.s.dt.oLoadedState?(r.iScroller=t.s.dt.oLoadedState.iScroller,r.iScrollerTopRow=t.s.dt.oLoadedState.iScrollerTopRow,i=!1):(r.iScroller=t.dom.scroller.scrollTop,r.iScrollerTopRow=t.s.topRowFloat)},"Scroller_State");this.s.dt.oLoadedState&&(this.s.topRowFloat=this.s.dt.oLoadedState.iScrollerTopRow||0);this.s.dt.aoDestroyCallback.push({sName:"Scroller",fn:function(){r(n).off("resize.DTS");r(t.dom.scroller).off("touchstart.DTS scroll.DTS");r(t.s.dt.nTableWrapper).removeClass("DTS");r("div.DTS_Loading",t.dom.scroller.parentNode).remove();t.dom.table.style.position="";t.dom.table.style.top="";t.dom.table.style.left=""}})},_fnScroll:function(){var t=this,u=this.s.heights,i=this.dom.scroller.scrollTop,n,f,e;if(!this.s.skip&&!this.s.ingnoreScroll){if(this.s.dt.bFiltered||this.s.dt.bSorted){this.s.lastScrollTop=0;return}this._fnInfo();clearTimeout(this.s.stateTO);this.s.stateTO=setTimeout(function(){t.s.dt.oApi._fnSaveState(t.s.dt)},250);(i<this.s.redrawTop||i>this.s.redrawBottom)&&(f=Math.ceil((this.s.displayBuffer-1)/2*this.s.viewportRows),Math.abs(i-this.s.lastScrollTop)>u.viewport||this.s.ani?(n=parseInt(this._domain("physicalToVirtual",i)/u.row,10)-f,this.s.topRowFloat=this._domain("physicalToVirtual",i)/u.row):(n=this.fnPixelsToRow(i)-f,this.s.topRowFloat=this.fnPixelsToRow(i,!1)),n<=0?n=0:n+this.s.dt._iDisplayLength>this.s.dt.fnRecordsDisplay()?(n=this.s.dt.fnRecordsDisplay()-this.s.dt._iDisplayLength,n<0&&(n=0)):n%2!=0&&n++,n!=this.s.dt._iDisplayStart&&(this.s.tableTop=r(this.s.dt.nTable).offset().top,this.s.tableBottom=r(this.s.dt.nTable).height()+this.s.tableTop,e=function(){t.s.scrollDrawReq===null&&(t.s.scrollDrawReq=i);t.s.dt._iDisplayStart=n;t.s.dt.oApi._fnCalculateEnd&&t.s.dt.oApi._fnCalculateEnd(t.s.dt);t.s.dt.oApi._fnDraw(t.s.dt)},this.s.dt.oFeatures.bServerSide?(clearTimeout(this.s.drawTO),this.s.drawTO=setTimeout(e,this.s.serverWait)):e(),this.dom.loader&&!this.s.loaderVisible&&(this.dom.loader.css("display","block"),this.s.loaderVisible=!0)));this.s.lastScrollTop=i;this.s.stateSaveThrottle()}},_domain:function(n,t){var i=this.s.heights,r,u,f;if(i.virtual===i.scroll){if(r=(i.virtual-i.viewport)/(i.scroll-i.viewport),n==="virtualToPhysical")return t/r;if(n==="physicalToVirtual")return t*r}return(u=(i.scroll-i.viewport)/2,f=(i.virtual-i.viewport)/2,r=f/(u*u),n==="virtualToPhysical")?t<f?Math.pow(t/r,.5):(t=f*2-t,t<0?i.scroll:u*2-Math.pow(t/r,.5)):n==="physicalToVirtual"?t<u?t*t*r:(t=u*2-t,t<0?i.virtual:f*2-t*t*r):void 0},_fnDrawCallback:function(){var n=this,i=this.s.heights,t=this.dom.scroller.scrollTop,l=t,a=t+i.viewport,h=r(this.s.dt.nTable).height(),u=this.s.dt._iDisplayStart,c=this.s.dt._iDisplayLength,e=this.s.dt.fnRecordsDisplay(),f,o,s;this.s.skip=!0;this._fnScrollForce();t=u===0?this.s.topRowFloat*i.row:u+c>=e?i.scroll-(e-this.s.topRowFloat)*i.row:this._domain("virtualToPhysical",this.s.topRowFloat*i.row);this.dom.scroller.scrollTop=t;this.s.baseScrollTop=t;this.s.baseRowTop=this.s.topRowFloat;f=t-(this.s.topRowFloat-u)*i.row;u===0?f=0:u+c>=e&&(f=i.scroll-h);this.dom.table.style.top=f+"px";this.s.tableTop=f;this.s.tableBottom=h+this.s.tableTop;o=(t-this.s.tableTop)*this.s.boundaryScale;this.s.redrawTop=t-o;this.s.redrawBottom=t+o;this.s.skip=!1;this.s.dt.oFeatures.bStateSave&&this.s.dt.oLoadedState!==null&&typeof this.s.dt.oLoadedState.iScroller!="undefined"?(s=(this.s.dt.sAjaxSource||n.s.dt.ajax)&&!this.s.dt.oFeatures.bServerSide?!0:!1,(s&&this.s.dt.iDraw==2||!s&&this.s.dt.iDraw==1)&&setTimeout(function(){r(n.dom.scroller).scrollTop(n.s.dt.oLoadedState.iScroller);n.s.redrawTop=n.s.dt.oLoadedState.iScroller-i.viewport/2;setTimeout(function(){n.s.ingnoreScroll=!1},0)},0)):n.s.ingnoreScroll=!1;setTimeout(function(){n._fnInfo.call(n)},0);this.dom.loader&&this.s.loaderVisible&&(this.dom.loader.css("display","none"),this.s.loaderVisible=!1)},_fnScrollForce:function(){var n=this.s.heights,t=1e6;n.virtual=n.row*this.s.dt.fnRecordsDisplay();n.scroll=n.virtual;n.scroll>t&&(n.scroll=t);this.dom.force.style.height=n.scroll+"px"},_fnCalcRowHeight:function(){var n=this.s.dt,i=n.nTable,e=i.cloneNode(!1),t=r("<tbody/>").appendTo(e),u=r('<div class="'+n.oClasses.sWrapper+' DTS"><div class="'+n.oClasses.sScrollWrapper+'"><div class="'+n.oClasses.sScrollBody+'"><\/div><\/div><\/div>'),f;for(r("tbody tr:lt(4)",i).clone().appendTo(t);r("tr",t).length<3;)t.append("<tr><td>&nbsp;<\/td><\/tr>");r("div."+n.oClasses.sScrollBody,u).append(e);n._bInitComplete?f=i.parentNode:(this.s.dt.nHolding||(this.s.dt.nHolding=r("<div><\/div>").insertBefore(this.s.dt.nTable)),f=this.s.dt.nHolding);u.appendTo(f);this.s.heights.row=r("tr",t).eq(1).outerHeight();u.remove()},_fnInfo:function(){var s,f,e,b;if(this.s.dt.oFeatures.bInfo){var n=this.s.dt,t=n.oLanguage,h=this.dom.scroller.scrollTop,c=Math.floor(this.fnPixelsToRow(h,!1,this.s.ani)+1),l=n.fnRecordsTotal(),i=n.fnRecordsDisplay(),a=Math.ceil(this.fnPixelsToRow(h+this.s.heights.viewport,!1,this.s.ani)),v=i<a?i:a,y=n.fnFormatNumber(c),p=n.fnFormatNumber(v),o=n.fnFormatNumber(l),w=n.fnFormatNumber(i),u;if(u=n.fnRecordsDisplay()===0&&n.fnRecordsDisplay()==n.fnRecordsTotal()?t.sInfoEmpty+t.sInfoPostFix:n.fnRecordsDisplay()===0?t.sInfoEmpty+" "+t.sInfoFiltered.replace("_MAX_",o)+t.sInfoPostFix:n.fnRecordsDisplay()==n.fnRecordsTotal()?t.sInfo.replace("_START_",y).replace("_END_",p).replace("_MAX_",o).replace("_TOTAL_",w)+t.sInfoPostFix:t.sInfo.replace("_START_",y).replace("_END_",p).replace("_MAX_",o).replace("_TOTAL_",w)+" "+t.sInfoFiltered.replace("_MAX_",n.fnFormatNumber(n.fnRecordsTotal()))+t.sInfoPostFix,s=t.fnInfoCallback,s&&(u=s.call(n.oInstance,n,c,v,l,i,u)),f=n.aanFeatures.i,typeof f!="undefined")for(e=0,b=f.length;e<b;e++)r(f[e]).html(u)}}},u.defaults={trace:!1,rowHeight:"auto",serverWait:200,displayBuffer:9,boundaryScale:.5,loadingIndicator:!1},u.oDefaults=u.defaults,u.version="1.2.2",typeof r.fn.dataTable=="function"&&typeof r.fn.dataTableExt.fnVersionCheck=="function"&&r.fn.dataTableExt.fnVersionCheck("1.9.0")?r.fn.dataTableExt.aoFeatures.push({fnInit:function(n){var t=n.oInit,i=t.scroller||t.oScroller||{},r=new u(n,i);return r.dom.wrapper},cFeature:"S",sFeature:"Scroller"}):alert("Warning: Scroller requires DataTables 1.9.0 or greater - www.datatables.net/download"),r.fn.dataTable.Scroller=u,r.fn.DataTable.Scroller=u,r.fn.dataTable.Api&&(f=r.fn.dataTable.Api,f.register("scroller()",function(){return this}),f.register("scroller().rowToPixels()",function(n,t,i){var r=this.context;if(r.length&&r[0].oScroller)return r[0].oScroller.fnRowToPixels(n,t,i)}),f.register("scroller().pixelsToRow()",function(n,t,i){var r=this.context;if(r.length&&r[0].oScroller)return r[0].oScroller.fnPixelsToRow(n,t,i)}),f.register("scroller().scrollToRow()",function(n,t){return this.iterator("table",function(i){i.oScroller&&i.oScroller.fnScrollToRow(n,t)}),this}),f.register("scroller().measure()",function(n){return this.iterator("table",function(t){t.oScroller&&t.oScroller.fnMeasure(n)}),this})),u};typeof define=="function"&&define.amd?define(["jquery","datatables"],r):typeof exports=="object"?r(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.Scroller&&r(jQuery,jQuery.fn.dataTable)})(window,document);
//# sourceMappingURL=dataTables.scroller.min.js.map
